# Stranger RSA

> Un de nos agents est parvenu à dérober une clé privée et un fichier chiffré à Evil Gouv. Retrouvez l'information, avec un peu d'imagination
>
> Le flag est juste une chaîne de caractères (sans le DGESIEE{})

On nous donne une clé privée `private.pem` et un fichier chiffré `EVIL-FILE.txt.enc`.

On peut déchiffrer le fichier grâce à la commande `openssl rsautl -decrypt -in EVIL-FILE.txt.enc -inkey private.pem`. On obtient le plaintext `221 x 7` qui n'est pas le flag.

Reste maintenant à trouver où se cache l'information. J'ai eu de nombreuses idées, parmi lesquelles:
- le flag est caché dans le padding PKCS7, qui contient de nombreux bytes random
- le flag est caché dans l'encryption du ciphertext
- il faut décrypter byte par byte avec comme clé publique (221, 7), qui donne un RSA symétrique (et donc étrange).

Finalement en affichant les différents paramètres n, p, q, etc, j'ai remarqué que `p` a l'air étrange:

> p = 8888887778888888877777777788888888777777888888888877777788887777777777887777777777888877777777888888888777778888888888877788888888877777788888887778888888887777778888888888777777888888887778888888888887777778888888877788888888888111988888881111111111138889111111111888887111111118883111111111188111111111188881111111111188889111111118888888811118888888111111119888888111988888891111111118888871111111111888888111188888888711111111888888811118888888888118111888888319888888871188888888881188881138888888888713888888888888888831188888118888888811888888888811988888311811888889118888888888888118111888888888888811888811188888888888888118311888888111888888888888111811888888888118883198888831188888888311888888891188888113111111188871111111118888888811388888811888888888118888811111888888118881188888113111111188888118883198888888888911888881188888888888888118889118888811311111118888118881188888887111111111188883138888888811888888111888888811888888311887118888888888888811388888881188888888113888888888811881117319119188811888888811887111111111188888881118888888118888888888888111111111188881188888891181117313117188883118888888111888111733311111788811117889188887111339111888311899999338888811388888888118333311113888119997311188999111311918888111939111183118888888111888111178891888881111333331187118888888111888811133911178399113111718888997888888889978879999999977888879999999998888887999997888879999999999888879788888888799999999778888879999997788888888889988888887999997788997888888889978799999999988888877799999778797888888889978888799999778888888889998611

Il contient beaucoup de 8 et de 7. J'ai d'abord essayé de convertir en binaire ou autre, avant de chercher les premiers chiffres sur Google et tomber sur [cette page](http://www.geocities.ws/chami000/some/Infy.txt).

J'ai donc compris qu'il fallait afficher p dans un rectangle de taille 221 x 7.

![p](images/stranger.png)

Flag: `AD26E7D346A2CA64`